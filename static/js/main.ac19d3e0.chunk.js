(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{27:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(20),c=n.n(r),i=n(8),l=(n(27),n(2)),o=n(3),u=n(0);var f=function(){return Object(u.jsx)("div",{className:"header",children:Object(u.jsx)("h1",{className:"header__title",children:"\u041c\u043e\u0440\u0441\u043a\u043e\u0439 \u0431\u043e\u0439"})})};var d=function(e){var t=e.setGameProps,n="Player",a=s.a.useState(n),r=Object(l.a)(a,2),c=r[0],o=r[1],f=s.a.useState("right"),d=Object(l.a)(f,2),j=d[0],h=d[1],m=function(e){var t=e.target.value;h(t)};return Object(u.jsxs)("form",{className:"start-form",children:[Object(u.jsxs)("div",{className:"start-form__wrapper",children:[Object(u.jsxs)("fieldset",{className:"start-form__fieldset",children:[Object(u.jsx)("legend",{className:"start-form__legend",children:Object(u.jsx)("h2",{className:"start-form__title",children:"\u0418\u043c\u044f"})}),Object(u.jsx)("input",{className:"start-form__input-name",name:"name",value:c,onChange:function(e){var t=e.target.value;o(t)},onClick:function(e){e.target.value===n&&o("")},onBlur:function(e){""===e.target.value&&o(n)}})]}),Object(u.jsxs)("fieldset",{className:"start-form__fieldset",children:[Object(u.jsx)("legend",{className:"start-form__legend",children:Object(u.jsx)("h2",{className:"start-form__title",children:"\u0421\u0442\u043e\u0440\u043e\u043d\u0430"})}),Object(u.jsxs)("label",{className:"start-form__radio-wrapper",children:[Object(u.jsx)("input",{className:"start-form__input-side",type:"radio",name:"side",value:"left",checked:"left"===j,onChange:m}),Object(u.jsx)("div",{className:"start-form__input-side-text",children:"\u043b\u0435\u0432\u0430\u044f\ud83d\ude30"})]}),Object(u.jsxs)("label",{className:"start-form__radio-wrapper",children:[Object(u.jsx)("input",{className:"start-form__input-side",type:"radio",name:"side",value:"right",checked:"right"===j,onChange:m}),Object(u.jsx)("div",{className:"start-form__input-side-text",children:"\u043f\u0440\u0430\u0432\u0430\u044f\ud83d\ude0e"})]})]})]}),Object(u.jsx)("div",{className:"start-form__btn-wrapper",children:Object(u.jsx)(i.b,{to:"/game",children:Object(u.jsx)("button",{className:"start-form__btn",onClick:function(){return t({name:c,side:j})},children:"\u0418\u0433\u0440\u0430\u0442\u044c"})})})]})};var j=function(){var e=s.a.useState(),t=Object(l.a)(e,2),n=t[0],a=t[1];return s.a.useEffect((function(){return a(JSON.parse(localStorage.getItem("battleshipStats")))}),[]),n?Object(u.jsxs)("div",{className:"stats",children:[Object(u.jsx)("h1",{className:"stats__title",children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}),Object(u.jsx)("table",{className:"stats__table",children:Object(u.jsxs)("tbody",{className:"stats__table-body",children:[Object(u.jsxs)("tr",{className:"stats__table-title-row",children:[Object(u.jsx)("th",{className:"stats__table-title",children:"\u0418\u043c\u044f \u0438\u0433\u0440\u043e\u043a\u0430"}),Object(u.jsx)("th",{className:"stats__table-title",children:"\u041f\u043e\u0431\u0435\u0434\u044b"}),Object(u.jsx)("th",{className:"stats__table-title",children:"\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u044f"})]}),n.map((function(e){var t=e.name,n=e.winCount,a=e.loseCount;return Object(u.jsxs)("tr",{className:"stats__table-row",children:[Object(u.jsx)("th",{className:"stats__table-cell",children:t}),Object(u.jsx)("th",{className:"stats__table-cell",children:n}),Object(u.jsx)("th",{className:"stats__table-cell",children:a})]},t)}))]})})]}):null};var h=function(e){var t=e.winnerName,n=e.removePlayersNames;return Object(u.jsxs)("div",{className:"end-game-window",children:[Object(u.jsxs)("h2",{className:"end-game-window__title",children:["\u0418\u0433\u0440\u043e\u043a ",t," \u043e\u0434\u0435\u0440\u0436\u0430\u043b \u043f\u043e\u0431\u0435\u0434\u0443!"]}),Object(u.jsxs)("div",{className:"end-game-window__btn-wrapper",children:[Object(u.jsx)(i.b,{to:"/battleship/",children:Object(u.jsx)("button",{className:"end-game-window__btn",onClick:function(){return n()},children:"\u0412\u044b\u0445\u043e\u0434"})}),Object(u.jsx)(i.b,{to:"/game",children:Object(u.jsx)("button",{className:"end-game-window__btn",onClick:function(){return n()},children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0435\u0449\u0451"})})]})]})},m=n(12),b=void 0,p=function(e){var t=e.id,n=e.isPlayerField,a=e.selectedShip,r=e.sendRotate,c=e.removeSelectedShip,i=e.endDeployState,o=e.shipsLengths,f=e.isDeployState,d=e.isCurMove,j=e.changeMove,h=e.endGame,p=s.a.useState(),O=Object(l.a)(p,2),_=O[0],N=O[1],g=s.a.useState([]),S=Object(l.a)(g,2),w=S[0],y=S[1],C=s.a.useState(),E=Object(l.a)(C,2),P=E[0],M=E[1],k=s.a.useState(),I=Object(l.a)(k,2),D=I[0],A=I[1],L=s.a.useState(),G=Object(l.a)(L,2),R=G[0],J=G[1],F=s.a.useState(),T=Object(l.a)(F,2),B=T[0],X=T[1],Y=s.a.useState([]),z=Object(l.a)(Y,2),q=z[0],H=z[1],K=s.a.useState([]),Q=Object(l.a)(K,2),U=Q[0],V=Q[1],W=s.a.useState(0),Z=Object(l.a)(W,2),$=Z[0],ee=Z[1];s.a.useEffect((function(){te(),!n&&ne()}),[]),s.a.useEffect((function(){return!n&&oe()}),[P]),s.a.useEffect((function(){return!n&&ce()}),[D]),s.a.useEffect((function(){return n&&w.length===o.length&&i()}),[w.length]),s.a.useEffect((function(){return n&&M(a)}),[a]),s.a.useEffect((function(){return n&&oe()}),[R,P]),s.a.useEffect((function(){return n&&d&&me()}),[d]),s.a.useEffect((function(){return j()}),[q,U]),s.a.useEffect((function(){return!f&&$===w.length&&h(t)}),[$]);var te=function(){for(var e=[],t=0;t<10;t++){e[t]=new Array(10);for(var n=0;n<10;n++)e[t][n]=null}N(e)},ne=function(){return o.forEach((function(e){return ae(e)}))},ae=function(e){setTimeout((function(){J(se()),M({length:e,isRotate:1===re(0,1)})}))},se=function(){return[re(0,9),re(0,9)]},re=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},ce=function(){f&&(!n&&D&&(B?ae(D.cells.length):y([].concat(Object(m.a)(w),[D]))),n&&!B&&P&&(y([].concat(Object(m.a)(w),[D])),c()))},ie=function(e,t){var n=null;if(w)for(var a=0;a<w.length;a++){var s=w[a].cells;if(s)for(var r=0;r<s.length;r++)if(s[r][0]===e&&s[r][1]===t)return n=a}return n},le=function(e){return n&&J(e)},oe=function(){if(P&&R){var e,t,n=P.length,a=P.isRotate,s=Math.floor(n/2),r=n%2===0,c=R[0],i=R[1],l=[];a?a&&(e=i,t=i):(e=c,t=c);for(var o=!1,u=0;u<s;){u++,e++,t--;var f=r&&u===s;if(o||(o=!fe(e,t,f,a)),a){if(l.push([c,e]),f)break;l.push([c,t])}else{if(l.push([t,i]),f)break;l.push([e,i])}}l.push(R),o||(o=!ue(l)),X(o),A({cells:l,hp:n})}},ue=function(e){if(w&&e){var t=[];w.forEach((function(e){return t.push(e.cells)}));for(var n=t.flat(),a=function(t){var a=n[t];if(a&&e.find((function(e){return e[0]===a[0]&&e[1]===a[1]})))return{v:!1}},s=0;s<n.length;s++){var r=a(s);if("object"===typeof r)return r.v}}return!0},fe=function(e,t,n,a){return n&&(a?t++:e--),e>=0&&e<10&&t>=0&&t<10},de=function(e,t){return D&&D.cells.find((function(n){return e===n[0]&&t===n[1]}))},je=function(e){return w[e]&&y(w.map((function(t,n){if(n===e){var a=--t.hp;return 0===a&&ee((function(e){return++e})),{cells:t.cells,hp:a}}return t})))},he=function(e,t,n){return e.find((function(e){return t===e[0]&&n===e[1]}))},me=function(){for(var e;e=se(),he(q,e[0],e[1]););H([].concat(Object(m.a)(q),[e]))},be=function(e){return V([].concat(Object(m.a)(U),[e]))};return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"field",onMouseLeave:function(){n&&(A(null),J(null))},onClick:function(){return ce()},children:_&&_.map((function(e,t){return e.map((function(e,a){var s,r=ie(t,a);return Object(u.jsx)(v,{isPlayerCell:n,preshow:le.bind(b),coords:[t,a],shipId:r,isDeployState:f,isDead:!f&&(s=r,w[s]&&0===w[s].hp),hit:je.bind(b),isAiMove:he(q,t,a),isPlayerMove:he(U,t,a),isCurMove:d,makeMove:be.bind(b)},t+a)}))}))}),n&&f&&Object(u.jsx)("div",{className:"field field--fake",children:_&&_.map((function(e,t){return e.map((function(e,n){return Object(u.jsx)(v,{isPreshowCell:P&&de(t,n),shipId:ie(t,n),isIncorrectPreshow:P&&B,isPlayerCell:!0},t+n)}))}))}),P&&n&&Object(u.jsx)(x,{ship:P,sendRotate:r,isDeployState:f})]})},v=function(e){var t=e.shipId,n=e.selectShip,a=e.isPlayerCell,r=e.preshow,c=e.coords,i=e.isPreshowCell,o=e.isIncorrectPreshow,f=e.isDeployState,d=e.isDead,j=e.hit,h=e.isAiMove,m=e.isPlayerMove,b=e.isCurMove,p=e.makeMove,v=e.isSelectedShip,O=t||0===t,x=s.a.useState(!1),_=Object(l.a)(x,2),N=_[0],g=_[1],S=s.a.useState(!1),w=Object(l.a)(S,2),y=w[0],C=w[1],E=b&&!a&&!f&&!N&&!y;s.a.useEffect((function(){(h||m)&&P()}),[h,m]);var P=function(){O?(g(!0),j(t)):C(!0)};return Object(u.jsx)("div",{onClick:function(e){return function(e){E?p(c):n&&n(t,e)}(e)},onMouseOver:function(){return r&&r(c)},style:{transition:a&&!f?"none":"background-color 1000ms ease"},className:"cell"+"".concat(O&&a?" cell--allied":"")+"".concat(a&&f&&!v?" cell--transparent":"")+"".concat(i&&!O?" cell--preshow":"")+"".concat(i&&o&&!O?" cell--incorrect":"")+"".concat(N&&!d?" cell--hit":"")+"".concat(d&&O?" cell--dead":""),children:"".concat(y?"\u26ab":"")})},O=function(e){var t=e.shipsLengths,n=e.sendShip,a=s.a.useState(),r=Object(l.a)(a,2),c=r[0],i=r[1],o=s.a.useState([]),f=Object(l.a)(o,2),d=f[0],j=f[1];s.a.useEffect((function(){h(),m()}),[]);var h=function(){for(var e=[],t=0;t<6;t++){e[t]=new Array(21);for(var n=0;n<21;n++)e[t][n]=null}i(e)},m=function(){var e=[],n=-1;t.forEach((function(t){var a=[];n+=2;for(var s=0;s<t;s++){var r=s+1;a.push([r,n])}e.push(a)})),j(e)},b=function(e,t){for(var n=null,a=0;a<d.length;a++)for(var s=d[a],r=0;r<s.length;r++)if(s[r][0]===e&&s[r][1]===t)return n=a;return n},p=function(e,t){if(e||0===e){var a=d[e].length;s=e,j(d.filter((function(e,t){return t!==s}))),n({id:e,length:a,x:t.pageX,y:t.pageY})}var s};return Object(u.jsxs)("div",{className:"ships-select-area__wrapper",children:[Object(u.jsx)("h2",{className:"ships-select-area__title",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043e\u0440\u0430\u0431\u043b\u0438"}),Object(u.jsx)("div",{className:"ships-select-area",children:c&&c.map((function(e,t){return e.map((function(e,n){return Object(u.jsx)(v,{shipId:b(t,n),selectShip:p.bind(undefined),isPlayerCell:!0},t+n)}))}))}),Object(u.jsxs)("ul",{className:"ships-select-area__tutorial",children:[Object(u.jsx)("li",{className:"ships-select-area__tutorial-item",children:"\u041b\u041a\u041c - \u0432\u044b\u0431\u043e\u0440/\u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u043a\u043e\u0440\u0430\u0431\u043b\u044f"}),Object(u.jsx)("li",{className:"ships-select-area__tutorial-item",children:"\u041f\u041a\u041c - \u043f\u043e\u0432\u043e\u0440\u043e\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u0440\u0430\u0431\u043b\u044f"})]})]})},x=function(e){var t=e.ship,n=e.sendRotate,a=e.isDeployState,r=s.a.useState(),c=Object(l.a)(r,2),i=c[0],o=c[1],f=s.a.useState(),d=Object(l.a)(f,2),j=d[0],h=d[1],m=s.a.useState(),b=Object(l.a)(m,2),p=b[0],O=b[1],x=s.a.useState(),_=Object(l.a)(x,2),N=_[0],g=_[1],S=s.a.useState(),w=Object(l.a)(S,2),y=w[0],C=w[1],E=s.a.useState(),P=Object(l.a)(E,2),M=P[0],k=P[1],I=s.a.useState(),D=Object(l.a)(I,2),A=D[0],L=D[1],G=s.a.useState(),R=Object(l.a)(G,2),J=R[0],F=R[1];s.a.useEffect((function(){return X()}),[]),s.a.useEffect((function(){if(J){var e=function(e){"mousemove"===e.type?B(e.pageX,e.pageY):"contextmenu"===e.type&&T(e)};return document.addEventListener("mousemove",e),document.addEventListener("contextmenu",e),B(t.x,t.y),function(){document.removeEventListener("mousemove",e),document.removeEventListener("contextmenu",e)}}}),[J]),s.a.useEffect((function(){return n(A)}),[A]);var T=function(e){e.preventDefault(),L((function(e){return!e}))},B=function(e,t){o(e-p/2),h(t-N/2)},X=function(){var e=t.length,n=50*e;o(t.x),h(t.y),O(50),g(n),C(1),k(e),L(!1);for(var s=new Array(e),r=0;r<e;r++)s[r]=Object(u.jsx)(v,{shipId:!0,isDeployState:a,isPlayerCell:!0,isSelectedShip:!0},r);F(s)};return Object(u.jsx)("div",{style:{left:"".concat(i,"px"),top:"".concat(j,"px"),width:"".concat(p,"px"),height:"".concat(N,"px"),gridTemplateColumns:"repeat(".concat(y,", 1fr)"),gridTemplateRows:"repeat(".concat(M,", calc(100% / ").concat(M,"))"),transform:"rotate(".concat(A?90:0,"deg)")},className:"selected-ship",children:J})};var _=function(e){var t=e.setGameProps;return Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)(d,{setGameProps:t}),Object(u.jsx)(j,{})]})},N=n(18),g=n(22),S=function e(t){Object(g.a)(this,e),t?(this.name=t,this.isAi=!1):(this.name="AI",this.isAi=!0)},w=void 0,y=function(e){var t=e.gameProps,n=e.sendPlayersNames,a=e.isEndGame,r=[4,3,3,2,2,2,1,1,1,1],c=s.a.useState([]),i=Object(l.a)(c,1)[0],f=s.a.useState(),d=Object(l.a)(f,2),j=d[0],h=d[1],m=s.a.useState(),b=Object(l.a)(m,2),v=b[0],x=b[1],_=s.a.useState(!0),g=Object(l.a)(_,2),y=g[0],C=g[1];s.a.useEffect((function(){"left"===t.side?(i.push(new S(t.name)),i.push(new S)):"right"===t.side&&(i.push(new S),i.push(new S(t.name))),h(i[0])}),[]);var E=function(){return C((function(e){return!e}))},P=function(e){var t=e;n({winnerName:i[0===t?1:0].name,loserName:i[t].name})},M=function(){return h((function(e){var t=e===i[0]?1:0;return i[t]}))},k=function(e){return x(e)},I=function(e){return x((function(t){return Object(N.a)(Object(N.a)({},t),{},{isRotate:e})}))};return a?Object(u.jsx)(o.a,{to:"/endgame"}):Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)("div",{className:"fields-wrapper",children:i.map((function(e,t){return Object(u.jsxs)("div",{className:"field-wrapper",style:{zIndex:1===t&&e.isAi?0:1},children:[Object(u.jsx)("h2",{className:"player-name",children:e.name}),Object(u.jsx)(p,{id:t,shipsLengths:r,isPlayerField:!e.isAi,selectedShip:!e.isAi&&v,sendRotate:I.bind(w),removeSelectedShip:k.bind(w),endDeployState:E.bind(w),isDeployState:y,isCurMove:!y&&j!==e,changeMove:M.bind(w),endGame:P.bind(w)})]},e.name)}))}),!y&&Object(u.jsxs)("h3",{className:"cur-move",children:["\u0425\u043e\u0434 \u0438\u0433\u0440\u043e\u043a\u0430 ",j.name,"..."]}),y&&Object(u.jsx)(O,{shipsLengths:r,sendShip:k.bind(w)})]})};var C=function(e){var t=e.winnerName,n=e.removePlayersNames;return Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)(h,{winnerName:t,removePlayersNames:n}),Object(u.jsx)(j,{})]})};var E=function(){var e=this,t=s.a.useState(),n=Object(l.a)(t,2),a=n[0],r=n[1],c=s.a.useState(),i=Object(l.a)(c,2),d=i[0],j=i[1];s.a.useEffect((function(){return d&&h()}),[d]);var h=function(){var e=JSON.parse(localStorage.getItem("battleshipStats"));e||(e=[]),[e.find((function(e){return e.name===d.winnerName})),e.find((function(e){return e.name===d.loserName}))].forEach((function(t,n){var a=0===n,s=a?d.winnerName:d.loserName,r=a?"winCount":"loseCount";t||(t={name:s,winCount:0,loseCount:0},e.push(t)),++t[r]})),m(e),e=JSON.stringify(e),localStorage.setItem("battleshipStats",e)},m=function(e){return e.sort((function(e,t){return t.winCount-e.winCount}))},b=function(){return j(null)};return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(f,{}),Object(u.jsx)(o.b,{path:"/battleship/",render:function(){return Object(u.jsx)(_,{setGameProps:r})},exact:!0}),Object(u.jsx)(o.b,{path:"/game",render:function(){return Object(u.jsx)(y,{gameProps:a,sendPlayersNames:j,isEndGame:!!d})},exact:!0}),Object(u.jsx)(o.b,{path:"/endgame",render:function(){return Object(u.jsx)(C,{winnerName:d.winnerName,removePlayersNames:b.bind(e)})},exact:!0})]})};c.a.render(Object(u.jsx)(i.a,{children:Object(u.jsx)(E,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.ac19d3e0.chunk.js.map